####  MySQL 为什么使用 B+ 树来作索引，对比 B 树它的优点和缺点是什么？
 B+ 树是多路平衡查找树，其**与 B 树的区别**主要在于：

- B 树中每个节点（包括叶节点和非叶节点）都存储真实的数据， B+ 树中只有叶子节点存储真实的数据，非叶节点只存储键。在 MySQL 中，这里所说的真实数据，可能是行的全部数据（如 Innodb 的聚簇索引），也可能只是行的主键（如 Innodb 的辅助索引），或者是行所在的地址（如MyIsam的非聚簇索引）；

- B 树中一条记录只会出现一次，不会重复出现，而 B+ 树的键则可能重复出现——一定会在叶节点出现，也可能在非叶节点重复出现；

- B+ 树的叶节点之间通过双向链表链接；

- B 树中的非叶节点，记录数比子节点个数少 1 ；而 B+ 树中记录数与子节点个数相同。

由此， B+ 树与 B 树相比，有以下**优势**：

- **更少的 I/O 次数**： B+ 树的非叶节点只包含键，而不包含真实数据，因此每个节点存储的记录个数比 B 树多很多（即阶 m 更大），因此 B+ 树的高度更低，访问时所需要的 I/O 次数更少。此外，由于每个节点存储的记录数更多，所以对访问局部性原理的利用更好，缓存命中率更高。

- **更适于范围查询**：在 B 树中进行范围查询时，首先找到要查找的下限，然后对 B 树进行中序遍历，直到找到查找的上限；而 B+ 树的范围查询，只需要对链表进行遍历即可。

- **更稳定的查询效率**： B 树的查询时间复杂度在 O(1) 到 O(Height) 之间（分别对应记录在根节点和叶节点），而 B+ 树的查询复杂度则稳定为树高，因为所有数据都在叶节点。

B+ 树也存在**劣势**：由于键会重复出现，因此会占用更多的空间。但是与带来的性能优势相比，空间劣势往往可以接受，因此 B+ 树在数据库中的使用比 B 树更加广泛。

#### Hash 索引与 B+ 树的不同？
- Hash 索引进行等值查询更快，但无法进行**范围查询**。因为 Hash 索引中经过 ```hash()``` 函数建立索引后，索引顺序与与原顺序无法保持一致，不能支持范围查询；而 B+ 树的所有节点皆遵循“左节点小于父节点，父节点小于右节点”，天然支持范围查询；
- Hash 索引不支持使用索引进行**排序**；
- Hash 索引不支持**模糊查询**以及多列索引的**最左前缀匹配**，原理也是因为 ```hash()``` 函数的不可预测；
- Hash 索引任何时候都必须进行**回表查询**，但 B+ 树在符合某些条件时可以只通过索引完成查询；
- Hash 索引虽然等值查询较快，但是极其**不稳定**，性能不可预测，但某一键值存在大量重复时，会发生 **Hash 碰撞**，此时效率可能十分低下；而 B+ 树的查询效率比较稳定，对于所有的查询均是从根节点到叶子节点，且树的高度较低。

鉴于以上不同点，因此在大多数情况下，直接选用 B+ 树索引能够获得稳定且较好的查询速度，而不需要使用 Hash 索引。
